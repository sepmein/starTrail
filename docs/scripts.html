<!DOCTYPE html>  <html> <head>   <title>scripts.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               scripts.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <h2>Stat Trail - simulating star trails on the sky with Raphealjs</h2>

<h3>使用RaphaelJS作为库，模拟星空长曝光轨迹</h3>

<h3>简单易用，设置选项丰富</h3>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>画布的dom容器，可以使用任何能想得到的方法指向dom元素，例如：</p>

<pre><code>document.getElementById(‘holder’);  
$('holder')[0]
</code></pre>

<p>等等...</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">holder</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;holder&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>画布对象，所有RaphaelJS的svg对象都包含在此画布中</p>

<p>(holder, 1280, 800)，第一个参数为dom容器，后两个参数分别代表画布大小，可随意修改</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">paper</span> <span class="o">=</span> <span class="nx">Raphael</span><span class="p">(</span><span class="nx">holder</span><span class="p">,</span> <span class="mi">1280</span><span class="p">,</span> <span class="mi">800</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p><strong>主配置</strong>，类型：对象</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">preference</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>中心位置，北极点的位置</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">P</span><span class="o">:</span> <span class="p">[</span><span class="mi">640</span><span class="p">,</span> <span class="mi">400</span><span class="p">],</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>星轨的初始角度，0代表一个点（没有角度）</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ALPHA</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>最远的星轨到中心的距离，越大分布越稀疏，getCoords算法会在最大范围内随机分配星星到中心的距离</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">MAXRANGE</span><span class="o">:</span> <span class="mi">1000</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>星轨条数，数目增大严重影响性能，3000左右能模拟真实自然界场景</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">NUMOFTRACE</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>星等参数，包含星等的数量及亮度信息</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">MAGNITUDE</span><span class="o">:</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>模拟自然界中星等，分别为一、二、三、四、五、六等星的数量</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">NUM</span><span class="o">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">738</span><span class="p">,</span> <span class="mi">2420</span><span class="p">],</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>各星等间亮度差异，越大亮暗差异越大，似乎过于复杂；元信息只有1.35，todo:修改算法</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">LIGHT</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span> <span class="o">/</span> <span class="mf">1.35</span><span class="p">]</span> 
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>星轨运行速度，完成一圈所需要的ms数</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">speed</span><span class="o">:</span> <span class="mi">120000</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>步进，星轨完成动画总共运行的角度</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">step</span><span class="o">:</span> <span class="mi">360</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>星空轨迹的配置</p>

<p>@argument preference 对象 </p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">function</span> <span class="nx">starTrail</span><span class="p">(</span><span class="nx">P</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>计算svg path elliptical arc算法的customAttributes函数</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">paper</span><span class="p">.</span><span class="nx">customAttributes</span><span class="p">.</span><span class="nx">arc</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">origin</span><span class="p">,</span> <span class="nx">degree</span><span class="p">,</span> <span class="nx">distance</span><span class="p">,</span> <span class="nx">alpha</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>coords: 坐标</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">coords</span> <span class="o">=</span> <span class="nx">getCoords</span><span class="p">(</span><span class="nx">origin</span><span class="p">,</span> <span class="nx">degree</span><span class="p">,</span> <span class="nx">distance</span><span class="p">,</span> <span class="nx">alpha</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>a: elliptical arc算法中标识弧度是否为大弧度（超过180~360）的量。就是因为这个量没搞明白，所以导致了<a href="http://spencer.kokiya.com/bigbang">bigbang bug</a>。</p>

<p>q:第二个参数的区间算法需要改进，0～180,180～360,360～540。。。</p>

<p>a:alpha相对180的倍数，再mod 2，这样就能划分区间</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">alpha</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>核心参数，
访问<a href="http://raphaeljs.com" title="查看文档">raphaeljs.com</a></p>

<p>M代表move，该点是由getCoords方法随机计算出来的</p>

<p>a代表elliptical arc，最后两个参数是弧线两个端点之间的坐标差值，由getCoords函数动态计算得出</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="s1">&#39;M&#39;</span> <span class="o">+</span> <span class="nx">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;a&#39;</span> <span class="o">+</span> <span class="nx">distance</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">distance</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="mi">0</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">a</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nx">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nx">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>返回 path string</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">path</span><span class="o">:</span> <span class="nx">path</span>
      <span class="p">};</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>星轨星等的变量，由magnitude()函数随机计算</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">paper</span><span class="p">.</span><span class="nx">customAttributes</span><span class="p">.</span><span class="nx">magnitude</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">magnitude</span><span class="p">();</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">stroke</span><span class="o">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span>
        <span class="s2">&quot;stroke-width&quot;</span><span class="o">:</span> <span class="nx">m</span><span class="p">.</span><span class="nx">strokeWidth</span><span class="p">,</span>
        <span class="nx">opacity</span><span class="o">:</span> <span class="nx">m</span><span class="p">.</span><span class="nx">opacity</span>
      <span class="p">}</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>getCoords方法，输入参数</p>

<pre><code>o,origin: 原点
d,degree: 角度
dis,distance: 到原点的距离
al,alpha: 不透明度，用来差别画显示各星星亮度
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">getCoords</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">d</span><span class="p">,</span> <span class="nx">dis</span><span class="p">,</span> <span class="nx">al</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">coords</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[],</span>
        <span class="p">[]</span>
      <span class="p">];</span>
      <span class="kd">var</span> <span class="nx">radians</span> <span class="o">=</span> <span class="p">(</span><span class="nx">d</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">,</span>
        <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">al</span> <span class="o">%</span> <span class="mi">360</span><span class="p">,</span>
        <span class="nx">radiansPlus</span> <span class="o">=</span> <span class="p">((</span><span class="nx">d</span> <span class="o">+</span> <span class="nx">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span>
      <span class="nx">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">640</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">radians</span><span class="p">)</span> <span class="o">*</span> <span class="nx">dis</span><span class="p">;</span>
      <span class="nx">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">400</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">radians</span><span class="p">)</span> <span class="o">*</span> <span class="nx">dis</span><span class="p">;</span>
      <span class="nx">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">640</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">radiansPlus</span><span class="p">)</span> <span class="o">*</span> <span class="nx">dis</span><span class="p">;</span>
      <span class="nx">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">400</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">radiansPlus</span><span class="p">)</span> <span class="o">*</span> <span class="nx">dis</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">coords</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">magnitude</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="p">{};</span>
      <span class="kd">var</span> <span class="nx">grade</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">g</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">g</span> <span class="o">=</span> <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">LIGHT</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">g</span> <span class="o">=</span> <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">LIGHT</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
            <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">g</span> <span class="o">=</span> <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">LIGHT</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
            <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">g</span> <span class="o">=</span> <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">LIGHT</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
            <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">g</span> <span class="o">=</span> <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">LIGHT</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
            <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">g</span> <span class="o">=</span> <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">LIGHT</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
            <span class="nx">preference</span><span class="p">.</span><span class="nx">MAGNITUDE</span><span class="p">.</span><span class="nx">NUM</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="nx">g</span><span class="p">;</span>
        <span class="p">}();</span>
      <span class="nx">m</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">=</span> <span class="nx">grade</span><span class="p">;</span>
      <span class="nx">m</span><span class="p">.</span><span class="nx">strokeWidth</span> <span class="o">=</span> <span class="nx">grade</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">m</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">set</span> <span class="o">=</span> <span class="nx">paper</span><span class="p">.</span><span class="nx">set</span><span class="p">();</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">P</span><span class="p">.</span><span class="nx">NUMOFTRACE</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">distance</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">P</span><span class="p">.</span><span class="nx">MAXRANGE</span><span class="p">,</span>
        <span class="nx">degree</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">360</span><span class="p">,</span>
        <span class="nx">al</span> <span class="o">=</span> <span class="nx">P</span><span class="p">.</span><span class="nx">ALPHA</span><span class="p">;</span>
      <span class="nx">set</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">paper</span><span class="p">.</span><span class="nx">path</span><span class="p">().</span><span class="nx">attr</span><span class="p">({</span>
        <span class="nx">magnitude</span><span class="o">:</span> <span class="p">[]</span>
      <span class="p">}).</span><span class="nx">attr</span><span class="p">({</span>
        <span class="nx">arc</span><span class="o">:</span> <span class="p">[</span><span class="nx">P</span><span class="p">.</span><span class="nx">P</span><span class="p">,</span> <span class="nx">degree</span><span class="p">,</span> <span class="nx">distance</span><span class="p">,</span> <span class="nx">al</span><span class="p">]</span>
      <span class="p">}));</span>
    <span class="p">}</span>

    <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">set</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
          <span class="nx">dis</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">arc</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
          <span class="nx">al</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">arc</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
        <span class="nx">el</span><span class="p">.</span><span class="nx">animate</span><span class="p">({</span>
          <span class="nx">arc</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="mi">640</span><span class="p">,</span> <span class="mi">400</span><span class="p">],</span> <span class="nx">d</span><span class="p">,</span> <span class="nx">dis</span><span class="p">,</span> <span class="p">(</span><span class="nx">al</span> <span class="o">+</span> <span class="nx">P</span><span class="p">.</span><span class="nx">step</span><span class="p">)]</span>
        <span class="p">},</span> <span class="nx">P</span><span class="p">.</span><span class="nx">speed</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">})();</span>

  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">st</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">StarTrail</span><span class="p">(</span><span class="nx">preference</span><span class="p">).</span><span class="nx">init</span><span class="p">();</span>
<span class="p">})();</span>


<span class="kd">function</span> <span class="nx">StarTrail</span><span class="p">(</span><span class="nx">pref</span><span class="p">,</span><span class="nx">pap</span><span class="p">){</span>

<span class="p">}</span>
<span class="nx">StarTrail</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>

<span class="p">}</span>
<span class="nx">St</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 